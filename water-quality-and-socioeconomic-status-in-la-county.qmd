---
title: "Water Quality and Socioeconomic Status In LA County"
format:
  html:
    code-fold: true
    code-summary: "Show the code"
editor: visual
---

# Does Household Income Have an Affect on Cardiovascular Health in LA County?

## Motivation

According to the CDC, cardiovascular-related diseases are the leading cause of death in America. Although there are a number of factors that influence cardiovascular diseases, I chose to study the relationship between median income of census tracts in Los Angeles County and the number of cardiovascular disease-related Emergency Department (ED) visits. The CalEnviroScreen data set used in this study aims to highlight which communities within California are the most impacted by pollution by using census tract data that includes socioeconomic and demographic information which can help further encapsulate the larger issue at hand : pollution burden. In this research project, I will conduct a difference in means hypothesis test of two groups : Extremely Low Income and Above Moderate Income to see if there is a true difference in average cardiovascular disease-related Emergency Department (ED) visits.

## Data 

CalEnviroScreen has recently celebrated their tenth anniversary since releasing their first version. Both California EPA and OEHHA (Office of Environmental Health Hazard Assessment) have collaboratively formulated this Environmental Justice screening tool as a means to help visualize impacts of pollution burden while accumultating

## Methods

```{r message = FALSE , warning=FALSE}
# loading in needed libraries

library(tidyverse)
library(dplyr)
library(ggplot2)
library(stats)
library(lubridate)
library(janitor)
library(sf)
library(stargazer)
library(ggpmisc)
```

```{r message=FALSE}

# reading in the data 

income_la <- read_csv('./data/Median_Income_and_AMI_(census_tract).csv') %>% 
  rename('census_tract' = 'tract')

# reading in water la data

los_angeles <- read_csv('data/cal_enviro_4.csv') %>% 
  clean_names() %>% 
  filter(california_county == 'Los Angeles')


# joining in the two datasets

income_water_la <- left_join(los_angeles, income_la, by = "census_tract") %>% 
  na.omit()


# preliminary plotting
income_cardio_tox_ed <- lm(cardiovascular_disease ~ med_hh_income + tox_release +education, data = income_water_la)

income_cardio <- lm(cardiovascular_disease ~ med_hh_income, data = income_water_la)

summary(income_cardio)

summary(income_water_la$med_hh_income)



```

Linear equation:

$$
cardiovasculardisease = \hat{\beta}_1income + \hat{\beta}_2toxicrelease + \hat{\beta}_3education + \hat{\beta}_4linguisticisolation
$$

```{r}

ggplot(income_water_la, aes(x = med_hh_income, y = cardiovascular_disease, col = education))+
  geom_point()+
  stat_smooth(method = 'lm', col = 'red')+
  labs(x = 'Median Household Income (USD)',
       y = 'Cardiovascular Disease-related ED visits per 10,000 people',
       title = '     Median Income vs. Cardiovascular Disease')+
  theme_classic()+
  stat_poly_eq()

  
```

```{r}


ggplot(data = income_water_la, aes(x = med_hh_income))+
  geom_histogram(bins = 100, fill = 'lightblue')+
  labs(x = 'Median Household Income (USD)',
       y = 'Number of Census Tract Groups')


# estimate for 10,000 increase in median income # add more variables and see how r squared changes;
# holding all other variables constant 
cardio_cases <- income_cardio$coefficients["med_hh_income"]* 10000

print(cardio_cases)

# with a 10,000 increase in median income, cardiovascular disease rates go down by .26 per 10000 people. include formula before linear regression ; B1 is income, B2 is tox_release; B3 is education; hypothesis is whether B is 0 or not 
```

```         
```

```{r}
## hypothesis test construction
# summary statistics for cardiovascular disease related ed visits

cardio_stats <- income_water_la %>% 
  group_by(ami_category) %>% 
  summarise(mean = mean(cardiovascular_disease),
            sd = sd(cardiovascular_disease))


print(cardio_stats)
```

```{r warning = FALSE}
# table of r squared values with different variables added 

m3 <- lm(cardiovascular_disease ~ med_hh_income + tox_release + education + linguistic_isolation, data = income_water_la)
m2 <- lm(cardiovascular_disease ~ med_hh_income + tox_release, data = income_water_la)
m1 <- lm(cardiovascular_disease ~ med_hh_income, data = income_water_la)


stargazer(m1, m2, m3, type="text",
          covariate.labels=c("Median Household Income","Toxic Air Release","Percentage of Adults over 25 without a High School Diploma", "Percent Limited English Speaking Households"))
```

**Interpretation of stargazer table:**

```         
```

$$H_{0}: \mu_{cardiodiseaseinExtrLowInc} - \mu_{cardiodiseaseinModInc}  = 0$$ $$H_{A}:  \mu_{cardiodiseaseinExtrLowInc} - \mu_{cardiodiseaseinModInc} \neq 0$$

$$SE = \sqrt{\frac{s_1^2}{n_1} + \frac{s^2_2}{n_2}}$$

```{r}
# computing a point estimate for both groups
mu_cardio_low <- income_water_la %>% 
  filter(ami_category == 'Extremely Low Income') %>% 
  summarize(mean(cardiovascular_disease))

mu_cardio_mod <- income_water_la %>% 
  filter(ami_category == 'Above Moderate Income') %>% 
  summarize(mean(cardiovascular_disease))


point_est_cardio <- as.numeric(mu_cardio_mod - mu_cardio_low) # will use for z-score 

# computing standard error

n1 <- income_water_la %>% 
  filter(ami_category == 'Extremely Low Income') %>% 
  count()

n2 <- income_water_la %>% 
  filter(ami_category == 'Above Moderate Income') %>% 
  count()

s1 <- income_water_la %>% 
  filter(ami_category == 'Extremely Low Income') %>% 
  summarize(sd(cardiovascular_disease, na.rm = TRUE))

s2<- income_water_la %>% 
  filter(ami_category == 'Above Moderate Income') %>% 
  summarize(sd(cardiovascular_disease, na.rm = TRUE))


# computing standard error

standard_error <-as.numeric(sqrt(s1^2/n1 + s2^2/n2))


# computing z-score
z <- (point_est_cardio - 0)/standard_error

print(z)


# z-score is around 8 standard deviations away from the mean  of 0 ?

```

```{r}

```

## Results

## Discussion

## Conclusion

## References
